<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æ–‡å‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°â‘ ï¼ˆè‚¯å®šæ–‡ï¼‰</title>

<style>
body{
  font-family:"Hiragino Maru Gothic ProN","Hiragino Maru Gothic",sans-serif;
  background:#fff9e6;
  padding:20px;
  text-align:center;
  font-size:20px;
}
h1{font-size:32px;margin-bottom:20px;}
.frame{
  max-width:900px;margin:auto;background:#ffffff;
  border:3px solid #f2c94c;border-radius:16px;padding:24px;
}
#type{font-size:22px;font-weight:bold;margin-bottom:10px;color:#d35400;}
#jp{font-size:26px;font-weight:bold;margin-bottom:20px;}
.row{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin:16px 0;}
#answerRow{min-height:80px;border:3px dashed #bbb;border-radius:12px;padding:12px;}
.card{
  background:#e6f5e6;padding:14px 18px;border-radius:12px;
  font-size:24px;font-weight:bold;cursor:pointer;
  box-shadow:2px 2px 6px rgba(0,0,0,.2);
}
button{padding:12px 24px;font-size:20px;border-radius:12px;margin:6px;}
#message{font-size:24px;font-weight:bold;height:32px;margin-top:10px;}
#nextBtn,#speakBtn{display:none;}
</style>
</head>

<body>

<h1>æ–‡å‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°â‘ ï¼ˆè‚¯å®šæ–‡ï¼‰</h1>

<div class="frame">
  <div id="type"></div>
  <div id="jp"></div>

  <div class="row" id="answerRow"></div>
  <div class="row" id="cardRow"></div>

  <button onclick="checkAnswer()">Check</button>
  <button onclick="shuffleCards()">Shuffle ğŸ”€</button>
  <button id="nextBtn" onclick="nextQ()">Next â–¶</button>
  <button id="speakBtn" onclick="speak()">ğŸ”Š éŸ³å£°</button>
  <button onclick="makePDF()">ğŸ“„ PDF</button>

  <div id="message"></div>
</div>

<script>

const typeDiv = document.getElementById("type");
const jpDiv = document.getElementById("jp");
const answerRow = document.getElementById("answerRow");
const cardRow = document.getElementById("cardRow");
const messageDiv = document.getElementById("message");
const nextBtn = document.getElementById("nextBtn");
const speakBtn = document.getElementById("speakBtn");

const questions=[

{type:"ç¬¬1æ–‡å‹ï¼ˆSVï¼‰",jp:"ãã®èµ¤ã¡ã‚ƒã‚“ã¯æ³£ã„ã¦ã„ã¾ã—ãŸã€‚",en:"The baby was crying."},
{type:"ç¬¬1æ–‡å‹ï¼ˆSVï¼‰",jp:"ç§ã¯å›³æ›¸é¤¨ã¸è¡Œãã¾ã—ãŸã€‚",en:"I went to the library."},

{type:"ç¬¬2æ–‡å‹ï¼ˆSVCï¼‰",jp:"ç©ºãŒé’ã„ã§ã™ã€‚",en:"The sky is blue."},
{type:"ç¬¬2æ–‡å‹ï¼ˆSVCï¼‰",jp:"å½¼å¥³ã¯å¹¸ã›ãã†ã«è¦‹ãˆã‚‹ã€‚",en:"She looks happy."},

{type:"ç¬¬3æ–‡å‹ï¼ˆSVOï¼‰",jp:"ç§ã¯ä¸€å†Šã®æœ¬ã‚’èª­ã¿ã¾ã—ãŸã€‚",en:"I read a book."},
{type:"ç¬¬3æ–‡å‹ï¼ˆSVOï¼‰",jp:"å½¼å¥³ã¯ãƒ”ã‚¢ãƒã‚’å¼¾ãã¾ã™ã€‚",en:"She plays the piano."},

{type:"ç¬¬4æ–‡å‹ï¼ˆSVOOï¼‰",jp:"ç§ã¯å½¼ã«æ‰‹ç´™ã‚’é€ã‚Šã¾ã—ãŸã€‚",en:"I sent him a letter."},
{type:"ç¬¬4æ–‡å‹ï¼ˆSVOOï¼‰",jp:"å½¼å¥³ã¯ç§ã«è³ªå•ã‚’ã—ã¾ã—ãŸã€‚",en:"She asked me a question."},

{type:"ç¬¬5æ–‡å‹ï¼ˆSVOCï¼‰",jp:"ã¿ã‚“ãªã¯å½¼ã‚’Gangdamã¨å‘¼ã³ã¾ã™ã€‚",en:"Everybody calls him Gangdam."},
{type:"ç¬¬5æ–‡å‹ï¼ˆSVOCï¼‰",jp:"ãã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¯ç§ã‚’å¹¸ã›ã«ã—ã¾ã—ãŸã€‚",en:"The news made me happy."}

];

let cur=0;

function wordsOf(i){
  return questions[i].en.replace(/([.,?])/g," $1 ").trim().split(/\s+/);
}

function loadQ(){
  messageDiv.textContent="";
  nextBtn.style.display="none";
  speakBtn.style.display="none";

  typeDiv.textContent="("+(cur+1)+") ã€"+questions[cur].type+"ã€‘";
  jpDiv.textContent="å’Œè¨³ï¼š "+questions[cur].jp;

  answerRow.innerHTML="";
  cardRow.innerHTML="";

  shuffle(wordsOf(cur)).forEach(w=>{
    const c=document.createElement("div");
    c.className="card";
    c.textContent=w;
    c.onclick=()=>toggle(c);
    cardRow.appendChild(c);
  });
}

function toggle(card){
  if(card.parentElement===cardRow){
    answerRow.appendChild(card);
  }else{
    cardRow.appendChild(card);
  }
}

function checkAnswer(){
  const user=[...answerRow.children].map(c=>c.textContent).join(" ").trim();
  const correct=wordsOf(cur).join(" ");

  if(user===correct){
    messageDiv.textContent="Correct! ğŸ‰";
    nextBtn.style.display="inline-block";
    speakBtn.style.display="inline-block";
  }else{
    messageDiv.textContent="Try again âŒ";
  }
}

function shuffleCards(){
  [...answerRow.children].forEach(c=>cardRow.appendChild(c));
  shuffle([...cardRow.children]).forEach(c=>cardRow.appendChild(c));
  messageDiv.textContent="";
  nextBtn.style.display="none";
  speakBtn.style.display="none";
}

function nextQ(){
  cur++;
  if(cur<questions.length){
    loadQ();
  }else{
    messageDiv.textContent="ãŠã¤ã‹ã‚Œã•ã¾ï¼Great job! ğŸŠ";
  }
}

function shuffle(a){
  return [...a].sort(()=>Math.random()-.5);
}

function speak(){
  const u=new SpeechSynthesisUtterance(questions[cur].en);
  u.lang="en-US";
  u.rate=0.75;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

function makePDF(){

  const w = window.open("");

  w.document.write(`
  <html>
  <head>
  <style>
  body{
    font-family:"Hiragino Maru Gothic ProN";
    padding:30px;
    font-size:18px;
  }
  h2{
    text-align:center;
    margin-bottom:20px;
  }
  .q{
    margin-bottom:28px;
    page-break-inside:avoid;
  }
  .type{
    font-weight:bold;
    color:#d35400;
  }
  .words{
    font-size:14px;
    margin:8px 0;
  }
  .line{
    border-bottom:1px solid #000;
    height:28px;
    margin-top:8px;
  }
  .page-break{
    page-break-before:always;
  }
  </style>
  </head>
  <body>
  <h2>æ–‡å‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°â‘ ï¼ˆè‚¯å®šæ–‡ï¼‰</h2>
  Name: ____________ã€€Date: ____________<br><br>
  `);

  // â­ å•é¡Œãƒšãƒ¼ã‚¸
  questions.forEach((q,i)=>{
    const shuffled = [...q.en.replace(/([.,?])/g," $1 ").trim().split(/\s+/)]
      .sort(()=>Math.random()-.5)
      .join(" / ");

    w.document.write(`
      <div class="q">
        <div class="type">(${i+1}) ã€${q.type}ã€‘</div>
        ${q.jp}<br>
        <div class="words">${shuffled}</div>
        <div class="line"></div>
      </div>
    `);
  });

  // â­ æ”¹ãƒšãƒ¼ã‚¸
  w.document.write(`
    <div class="page-break"></div>
    <h2>Answer</h2>
  `);

  // â­ ç­”ãˆãƒšãƒ¼ã‚¸
  questions.forEach((q,i)=>{
    w.document.write(`
      <div>
        (${i+1}) ${q.en}
      </div>
    `);
  });

  w.document.write("</body></html>");
  w.document.close();
  w.print();
}
loadQ();

</script>
</body>
</html>